<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> CSV lasītājs</title>
    <link rel="stylesheet" href="style.css">
    <script>
        //Šeit būs JS kods
        //Funkcija nr 1
        function readFile(event) {
            //šeit rakstam funkciju, kas izlasa .csv failu
            //Definējam mainīgo, kas saturēs faila saturu
            let file = event.target;
            //Definējam mainīgo, kas lasīs .csv failu
            let reader = new FileReader();

            //Funkcija, kas tiek izsaukta, lai parādītu faila saturu
            //funkcija nr 2
            reader.onload = function() {
                //Definējam mainīgo, kurš var piekļūt tabulai
                let table = document.getElementById('result');
                let text = reader.result;
                //Izsauc jaunu funkciju, kas par parametriem pieņem jau definētos mainīgos
                displayContent(text, table);
            }
            //Izlasam failu
            reader.readAsText(file.files[0]);
        }
        //funkcija nr 3
        function displayContent(text, table) {
            //Definēts mainīgais, kas sadala teksta bloku daļās pēc konkrētas pazīmes vai atdalītāja
            let rows = text.split('\n')
            //Tukša tabula
            table.innerHTML = '';

            //Pārbaudam cik ir rindas CSV
            console.log("Rindu skaits: " + rows.length)
            //For cikls, lai izveidotu tabulas rindas un kolonnas un ielasītu CSV saturu tajās
            for (let rinda = 0; rinda < rows.length; rinda++) {
                //Izveidojam rindas tabulā
                //Definējam mainīgo, kas ir viena tabulas rinda
                const row =  table.insertRow(rinda);
                //console.log(rinda)

                //Sadalam katru rindu gabalos uz katru komatu
                const columns = rows[rinda].split(',')

                //jauns for cikls, lai izveidu tabulas šūnas
                for (let kolonna = 0; kolonna < columns.length; kolonna++) {
                    const cell = row.insertCell(kolonna);

                    cell.innerHTML = columns[kolonna]
                }

            }
            

        }

    </script>
</head>
<body>
    <h1>CSV lasītājs</h1>

    <!-- Input field -->
    <form>
        <input type="file" onchange="readFile(event)" accept=".csv">
    </form>
    <!-- Tabula kurā tiks ievietota informācija no csv faila -->
    <table id="result">

    </table>
</body>
</html>